Hotelling's model of exhaustible resource extraction provides simple but useful economic intuitions about the trade-off between extraction today and extraction in the future in the context of the forward-looking resource owners. The framework is flexible in applying to real-world resource extraction problems, such as exploration \citep{The-Optimal-Exploration-and-Production-of-Nonrenewable-Resources_Pindyck_1978, Optimal-Pricing-Use-and-Exploration-of-Uncertain-Natural-Resource-Stocks_Arrow-and-Chang_1982, Exploration-and-Exhaustible-Resources_The-Microfoundations-of-Aggregate-Models_Swierzbinski-and-Mendelsohn_1989, Exhaustible-Resources_A-Theory-of-Exploration_Quyen_1991}, uncertainty over reserves/demand/price \citep{Optimal-Depletion-of-an-Uncertain-Stock_Gilber_1979, Uncertainty-and-Exhaustible-Resource-Markets_Pindyck_1980, The-Optimal-Production-of-an-Exhaustible-Resource-When-Price-is-Exogenous-and-Stochastic_Pindyck_1981, Extraction-at-the-Intensive-Margin_Farrow-and-Krautkraemer_1989}, taxation effects \citep{Economics-of-Depletatble-Resources_Market-Forces-and-Intertemporal-Bias_Sweeney_1977, The-Taxation-of-Nonreplenishable-Natural-Resources-Revisited_Heaps_1985}, and technological improvement \citep{Growth-with-Exhaustible-Natural-Resources_Efficient-and-Optimal-Growth-Paths_Stiglitz_1974, Trends-in-Natural-Resource-Commodity-Prices_An-Analysis-of-the-Time-Domain_Slade_1982}. Accordingly, economists have utilized this canonical theory of the optimal depletion of nonrenewable resources for many decades to understand how exhaustible resource markets function. Hotelling's model, however, shows a different story in terms of empirical work. The main focus of the empirical literature on the Hotelling framework has been to test the well-known $r$-percent rule that a resource's shadow price has to rise at the rate of interest $r$. Unfortunately, such attempts have not been very fruitful due to various econometric issues and the fact that resource rents are generally unobservable.\footnote{See \cite{Natural-Resource-Economics-under-the-Rule-of-Hotelling_Gaudet_2007} and \cite{Whither-Hotelling-Tests-of-the-Theory-of-Exhaustible-Resources_Slade-and-Thille_2009}.} Furthermore, recent empirical work on oil and gas extraction tends not to use Hotelling's theoretical model.\footnote{
\cite{The-Effect-of-Uncertainty-on-Investment-Evidence-from-Texas-Oil-Drilling_Kellogg_2014} examines the relationship between drilling investments in Texas and oil price volatility. \cite{Experiential-Gains-with-a-New-Technology_2015_(Fitzgerald)} studies experiential gains in hydraulic fracturing. \cite{The-Housing-Market-Impacts-of-Shale-Gas-Development_Muehlenbach-Lucija-and-Timmins_2015}  investigates the impacts of shale gas development on the housing market. \cite{Drilling-Like-Theres-No-Tomorrow_Boomhower_2019} examines the effects of bankruptcy protection on industry structure and environmental outcomes. \cite{Patchwork-Policies-Spillovers-and-the-Search-for-Oil-and-Gas_Lewis_2019} studies the effects of a complex patchwork of mineral ownership on the oil and gas extraction outcomes. Using a government oil lease lottery, \cite{Information-Asymmetry-Trade-and-Drilling_Evidence-from-an-Oil-Lease-Lottery_Brehm-and-Lewis_2021} shows that initial assignment results in different trade, drilling, and production outcomes.} 

\cite{Hotelling-under-Pressure_AKS_2018} (AKS) extends Hotelling's model by adding a new layer to oil producers' decision-making. AKS allows extractors to manipulate the rate of extraction from each well (the intensive margin) as well as the rate of drilling new wells (the extensive margin). The authors document several stylized facts about oil production: 1) oil production from existing wells is unresponsive to oil prices, which is inconsistent with Hotelling's classic model; however, 2) the rate of drilling is responsive to oil prices. The authors can reconcile these stylized facts with their reformulation of the Hotelling model. 

Adding the heterogeneous geological features of different well sites is a natural augmentation to the AKS theoretical model. As discussed in \cite{Learning-where-to-drill_Agerton_2020}, variation in geological characteristics, which we denote \textit{resource quality}, is a key driver of well-level productivity and firms' extraction decisions. We extend the AKS framework to incorporate heterogeneity in resource quality and well-level cost shocks. This extension has several benefits. First, we can accommodate what we see empirically in U.S. production---that firms develop high- and low-quality resources at the same time. Second, our specification is both analytically tractable, allowing for analysis with standard optimal control methods, as well as empirically tractable, allowing for econometric estimation. 

To examine the validity of our extended model, we empirically analyze the resource quality of horizontal wells in North Dakota. As is well known, the geological quality of a given well site is usually observable only by extraction firms, though there are publicly available data that we can exploit to gauge it, such as the geological survey data published by the North Dakota Geological Survey (NDGS). Inspired by \cite{The-Economics-of-Time-Limited-Development-Options_2020_Herrnstadt-Kellogg-and-Lewis}, we use Robinson's partial linear model with detailed well-level data on horizontal wells drilled in North Dakota to estimate resource quality in each location. This estimation process provides us with two interesting stylized facts. One interesting fact is that fracking firms in North Dakota drilled well sites with different levels of resource quality simultaneously. The other empirical fact we discovered is that drilling of low-quality well locations decreased more than that of high-quality ones in response to the oil price drops during the second half of 2014. 

The stylized facts from our analysis of the quality of drilled well sites in North Dakota raise two issues in modeling fracking firms' drilling activity based on the extended AKS framework. First, we find that the AKS-style model incorporating well sites' heterogeneous resource quality cannot rationalize the simultaneous drilling of well sites with different quality levels. Simply put, the model is not able to explain the empirical finding. Second, the simultaneous drilling of well locations with heterogeneous resource quality is inconsistent with the well-known least-cost-first extraction rule in exhaustible resource extraction. \cite{Extraction-Capacity-and-the-Optimal-Order-of-Extraction_Holland_2003}, which shows that limited extraction capacity causes the rule not to hold, seems to indicate that we need to include additional extraction-capacity-associated constraints that are highly sophisticated to model to make our extended model describe the empirical facts well. In this context, we suggest adopting a different approach to developing an economic model that enables us to explain fracking firms' drilling activity observed in North Dakota convincingly. 

In this paper, following \cite{Estimation-of-Dynamic-Discrete-Choice-Models-in-Continuous-Time_ABBE_2016}, we develop a Discrete Choice Dynamic Programming (DCDP) framework in continuous time to model firms' drilling decisions. In this theoretical model, we formulate the decision to drill as an optimal stopping problem that trades off drilling a given well site today against drilling it at some time in the future. This trade-off is also the central idea of Hotelling's classic model. In our formulation, we introduce choice-specific cost shocks $\epsilon$'s that allow us to address the two problems we faced with respect to the extended AKS-style model. Because the cost shocks reflect a range of constraints that affect oil production companies' drilling decisions but are difficult to quantify by econometricians, they allow us to avoid adding various constraints to our model. Our model incorporating the cost shocks can also rationalize the empirical finding that fracking firms in North Dakota drilled horizontal wells with heterogenous quality simultaneously. Furthermore, under the assumption of a continuum of infinitesimally small well sites, our framework enables us to compute market-level drilling and production by aggregating the drilling decision for the marginal well location. In addition to its analytical tractability, one of the main advantages of the DCDP framework is that the model is estimable empirically using microeconomic data, which are available from both commercial and government databases. 

We examine the equilibrium dynamics implied by our DCDP model in continuous time, especially focusing on how hydraulic fracking firms adjust their drilling, and thus oil production, in response to changes in oil prices under different conditions. First, we investigate the impact of unexpected demand shocks on the evolution of optimal drilling paths. Our simulation shows that a negative demand shock results in an immediate decrease in drilling, oil production, and the equilibrium oil price and that the equilibrium oil price gradually increases after the discontinuous drop. Second, we simulate how firms' drilling activity on well locations with heterogenous resource quality responds to unexpected price shocks. The time paths from this simulation demonstrate an interesting result that is consistent with our empirical observation: they reduced the drilling of low-quality well sites more than that of high-quality ones. Third, we compute the time paths of optimal drilling of horizontal wells and oil production from them under two distinct types of oil prices---exogenous and endogenous oil prices. The obtained equilibrium paths show that exogenous oil prices cause a higher drilling rate over the early period in our simulation. 

The rest of this paper proceeds as follows. Section \ref{C3-Section:Data-and-Empirical-Analysis} discusses a set of data utilized for this research and the results from our empirical analysis. In Section \ref{C3-Section:A-DCDP-Model-in-Continuous-Time}, we develop a continuous-time DCDP model for drilling decisions in oil and gas extraction. Section \ref{C3-Section:Equilibrium-Dynamics-with-Oil-Prices} presents, under distinct conditions, the time paths of optimal drilling and oil production implied by our model, and Section \ref{C3-Section:Conclusion} concludes. 
