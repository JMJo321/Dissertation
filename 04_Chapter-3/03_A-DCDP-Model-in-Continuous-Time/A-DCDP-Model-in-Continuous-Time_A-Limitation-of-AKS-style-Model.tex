The theoretical framework for optimal oil drilling and extraction delineated in \cite{Hotelling-under-Pressure_AKS_2018} (AKS) can be augmented by integrating heterogeneity in the quality of well locations. Suppose that the fracking firm owns well sites of different qualities, indexed by $g \in \{L(ow), H(igh)\}$, and that a homogeneous good (i.e., oil) is yielded from the sites in which new horizontal wells are drilled. Furthermore, suppose that the unit price of the output, $\widebar{p}$, is determined exogenously due to the firm's total production being negligible in comparison to the global market for the output. The maximization problem of the firm owning a continuum of infinitesimal well locations with disparate qualities can be articulated as follows:
\input{04_Chapter-3/00C_Equations/Equation_AKS-Style-Model.tex}
In this formulation, state variables $R^{g}(t)$ denote the measure of undrilled well sites at a given time $t$. We simplify the AKS model by assuming that firms always produce at their production capacity constraint. This assumption reduces the complexity of the model. Control variables $d^{g}(t)$ represent the rate at which new horizontal wells are drilled at time $t$. $\alpha^{g}$ are the quantity of oil production from the marginally drilled well. Here, we assume that $\alpha^{H} > \alpha^{L}$. $C(\cdot)$, indicating the total instantaneous cost of drilling, is solely a function of the drilling rates.\footnote{Regarding the total cost of oil production, we follow the assumption made in \cite{Hotelling-under-Pressure_AKS_2018}: per-barrel extraction costs from existing wells are negligible.} Of note, in this formulation for $C(\cdot)$, we assume that locations are perfect substitutes on the cost side. And the profit obtained at time $t$ is discounted at the interest rate $r$.  

The current-value Hamiltonian-Lagrangian of the firm's problem is
\input{04_Chapter-3/00C_Equations/Equation_AKS-Style-Model_The-Current-Value-Hamiltonian.tex}
where $\pi^{g}_{R}$ are costate variables for the state variables $R^{g}$. $\lambda_{j}, \ j \in \{1, 2\}$ are the shadow cost of each constraint.

For a given quality level $g$, two necessary conditions characterize the firm's optimal rate of drilling:
\input{04_Chapter-3/00C_Equations/Equation_AKS-Style-Model_Two-Necessary-Conditions.tex}
When horizontal wells with heterogeneous quality are drilled simultaneously (i.e., for each $g$, $d^{g}(t) >0$, which leads to $\lambda_{1}^{g}(t) = 0$), necessary condition (\ref{Equation:AKS-Style-Model_Necessary-Conditions_pi-K}) implies that the shadow price on the resource constraint at time $t$ equals the profit on the marginal well:
\input{04_Chapter-3/00C_Equations/Equation_AKS-Style-Model_Shadow-Price-pi.tex}
In addition, when both types of horizontal well sites are not fully exhausted (i.e., for each $g$, $R^{g}(t) > 0$, which in turn $\lambda_{2}^{g}(t) = 0$), necessary condition (\ref{Equation:AKS-Style-Model_Necessary-Conditions_pi-R}) means that the shadow value of the marginal undrilled well at time $t$ grows at the rate of $r$:
\input{04_Chapter-3/00C_Equations/Equation_AKS-Style-Model_Simplified-pi.tex}

The necessary conditions collectively suggest that the simultaneous drilling of horizontal wells with heterogeneous quality cannot be justified in the AKS framework when $d^{g}(t) > 0$ and $R^{g}(t) > 0$, which hold before all available well sites are developed.
The following stems from equation (\ref{Equation:AKS-Style-Model_Necessary-Conditions_Shadow-Price-pi}):
\input{04_Chapter-3/00C_Equations/Equation_AKS-Style-Model_Conditions-for-Contradiction_Difference.tex}
This relationship implies that the difference in the shadow value between high- and low-quality well locations is simply a revenue difference at any time $t$. And as shown below, differentiating equation (\ref{Equation:AKS-Style-Model_Necessary-Conditions_Shadow-Price-pi}) with respect to time implies that for a given $C'' (\cdot)$, $\dot{d}^{g} (t)$ and $d^{g} (t)$ determine the value of the time derivative of $\pi_{t}^{g} (t), \ g \in \{L, H\}$ and that $\dot{\pi}_{t}^{L} (t)$ and $\dot{\pi}_{t}^{H} (t)$ have the same value at a given time $t$:
\input{04_Chapter-3/00C_Equations/Equation_AKS-Style-Model_Conditions-for-Contradiction_Time-Derivative.tex}
Here, based on equation (\ref{Equation:AKS-Style-Model_Necessary-Conditions_Simplified-pi}), the relationship between the time derivatives for two distinct qualities indicates that $\pi^{L} (t) = \pi^{H} (t)$ holds at all time $t$. However, this equality contradicts equation (\ref{Equation:AKS-Style-Model_Difference-between-pis}) because $\alpha^{H} > \alpha^{L}$. In other words, the simultaneous drilling of horizontal wells with heterogeneous quality does not hold in the AKS framework. 

Adding a constraint on extraction capacity, as is done in \cite{Extraction-Capacity-and-the-Optimal-Order-of-Extraction_Holland_2003}, can suggest that simultaneous extraction of different resource qualities is optimal. However, in the framework, setting the upper bound of an extraction-related constraint seems too arbitrary and complicates drawing implications from necessary conditions. From the empirical perspective, it is also intractable to quantify the margin for market-wide, or firm-wide, extraction capacity for each drilling decision. Furthermore, empirical estimation of the model from microeconomic data on drilling and production is, in general, too demanding. Those difficulties call for a new theoretical approach that thoroughly explains our empirical findings for drilling decisions made by fracking firms in North Dakota. 

The need leads us to develop a continuous-time Discrete Choice Dynamic Programming (DCDP) model that formulates a firm's drilling decision on a particular well site as an optimal stopping problem. Under this new theoretical framework, we can rationalize the simultaneous drilling of horizontal wells with heterogeneous resource quality without specifying any capacity constraint. Moreover, our DCDP model yields empirically testable predictions about how firms' drilling and production activities vary with oil prices. In the next section, we will present the basic elements and assumptions of our DCDP framework. 
